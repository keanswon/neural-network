TODO for v2:
    add batching
    add multithreading
    use different activation function